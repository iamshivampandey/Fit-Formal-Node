SELECT DISTINCT
  o.orderId,
  o.customerId,
  o.orderDate,
  o.orderType,
  o.totalAmount,
  o.paymentStatus,
  o.advancePaid,
  o.deliveryDate,
  o.notes,
  o.createdBy,
  o.createdAt,
  o.updatedAt
FROM Orders o
INNER JOIN OrderItems oi ON o.orderId = oi.orderId
WHERE oi.shopId = {{shopId}}
  {{#if date}}AND CAST(o.orderDate AS DATE) = CAST('{{date}}' AS DATE){{/if}}
ORDER BY o.createdAt DESC;

